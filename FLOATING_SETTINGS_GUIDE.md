# 🎈 TimeNest 独立浮窗设置指南

## 📋 功能概述

TimeNest 现在提供了独立的浮窗设置对话框，以浮窗形式显示，完美兼容所有浮窗设置功能。

### ✨ 主要改进

1. **🗑️ 删除应用设置中的浮窗设置选项卡**
   - 从主应用设置对话框中移除了浮窗设置选项卡
   - 简化了应用设置界面
   - 避免了设置界面的冗余

2. **🎈 独立浮窗设置对话框**
   - 以独立浮窗形式显示
   - 支持拖拽移动
   - 美观的圆角透明设计
   - 总是置顶显示

3. **🔧 完整功能兼容**
   - 保留所有原有的浮窗设置功能
   - 实时预览设置效果
   - 支持配置保存和加载
   - 完整的信号系统

## 🚀 使用方法

### 方法1: 通过托盘菜单
1. 右键点击系统托盘中的TimeNest图标
2. 选择"浮窗设置"选项
3. 独立的浮窗设置对话框将会显示

### 方法2: 通过浮窗右键菜单
1. 右键点击浮窗本身
2. 选择"🎈 浮窗设置"选项
3. 设置对话框将会显示

### 方法3: 通过快捷键（如果配置）
- 使用配置的快捷键直接打开浮窗设置

## ⚙️ 设置功能详解

### 🎨 外观设置
- **透明度**: 调整浮窗的透明度 (10%-100%)
- **尺寸**: 设置浮窗的宽度和高度
- **圆角**: 调整浮窗边角的圆润程度

### 📍 位置设置
- **位置预设**: 
  - 屏幕顶部居中
  - 屏幕顶部左侧
  - 屏幕顶部右侧
  - 屏幕底部居中
  - 自定义位置
- **自定义坐标**: 精确设置X、Y坐标

### 🧩 模块管理
- **可用模块**:
  - ⏰ 时间显示
  - 📅 课程表
  - 🌤️ 天气信息
  - 📆 日历
  - 📋 任务提醒
- **功能**:
  - 拖拽调整显示顺序
  - 勾选启用/禁用模块

### 🖱️ 交互设置
- **鼠标穿透**: 让鼠标事件穿透浮窗
- **自动隐藏**: 在特定条件下自动隐藏浮窗
- **总是置顶**: 保持浮窗在所有窗口之上

## 🎯 操作指南

### 打开设置对话框
```python
# 通过浮窗管理器
floating_manager.show_settings_dialog()

# 通过托盘功能
tray_features.show_floating_settings()

# 通过浮窗组件
floating_widget.show_settings()
```

### 应用设置
1. 在设置对话框中调整各项参数
2. 点击"✅ 应用"按钮
3. 设置将立即生效并保存

### 重置设置
1. 点击"🔄 重置"按钮
2. 所有设置将恢复为默认值
3. 需要再次点击"应用"来生效

### 关闭对话框
- 点击"❌ 关闭"按钮
- 点击标题栏的"✕"按钮
- 按ESC键（如果支持）

## 🔧 技术特性

### 窗口属性
- **窗口类型**: Tool窗口，不在任务栏显示
- **窗口标志**: 无边框、总是置顶
- **透明背景**: 支持半透明效果
- **拖拽移动**: 支持鼠标拖拽移动位置

### 样式设计
- **圆角设计**: 15px圆角，现代化外观
- **透明背景**: 半透明白色背景
- **阴影效果**: 自然的阴影效果
- **响应式布局**: 自适应内容大小

### 信号系统
- `settings_changed`: 设置变化信号
- `settings_applied`: 设置应用信号
- `dialog_closed`: 对话框关闭信号

## 📝 配置文件

设置保存在配置文件的`floating_widget`节点中：

```yaml
floating_widget:
  opacity: 0.9
  width: 400
  height: 60
  border_radius: 30
  position_preset: "屏幕顶部居中"
  x: 100
  y: 10
  mouse_transparent: true
  auto_hide: false
  always_on_top: true
  modules:
    time:
      enabled: true
      order: 0
    schedule:
      enabled: true
      order: 1
    weather:
      enabled: false
      order: 2
```

## 🎨 自定义样式

设置对话框支持主题系统，会自动应用当前主题的颜色和字体设置。

### 默认样式特性
- **背景色**: 半透明白色
- **边框**: 圆角边框
- **按钮**: 蓝色渐变按钮
- **滑块**: 自定义样式滑块
- **字体**: 系统默认字体

## 🔍 故障排除

### 设置对话框不显示
1. 检查浮窗管理器是否正常初始化
2. 确认没有其他模态对话框阻挡
3. 尝试重启应用

### 设置不生效
1. 确认点击了"应用"按钮
2. 检查配置文件权限
3. 查看日志文件中的错误信息

### 对话框位置异常
1. 设置对话框会自动居中显示
2. 支持拖拽移动到合适位置
3. 重启应用会重置到默认位置

## 🚀 未来扩展

### 计划功能
- **主题预设**: 预定义的外观主题
- **动画效果**: 更丰富的动画效果
- **快捷键**: 自定义快捷键支持
- **多显示器**: 多显示器环境优化

### 开发接口
```python
# 扩展新的设置组
def create_custom_group(self, layout):
    """创建自定义设置组"""
    pass

# 添加新的模块类型
module_map = {
    'custom': CustomModule,
}
```

---

**🎉 现在您可以享受更加便捷和美观的浮窗设置体验！**
